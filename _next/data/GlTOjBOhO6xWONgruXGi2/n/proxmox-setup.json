{"pageProps":{"note":{"title":"Proxmox VE 기초설정","description":"Proxmox VE 설치 후 해야하는 기초 설정","date":"2023-03-18T00:00:00.000Z","tags":null,"body":{"raw":"\n## 유저 설정하기\n\n항상 시스템 구성하면 root 외의 유저 계정 생성하고 SSH 접속 제한하자.\n\n서버에 접속하여 `adduser`로 유저를 생성한다.\n\n```\n$ adduser nyeong\n$ apt install sudo\n$ groupadd sudoers\n$ usermod -g suoders nyeong\n$ EDITOR=vi visudo\n$ su nyeong\n```\n\n로컬로 빠져나와 SSH 공개키를 서버로 복사한다.\n\n```\n$ ssh-copy-id 192.168.1.100\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: \"/Users/nyeong/.ssh/id_ed25519.pub\"\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\nnyeong@192.168.1.100's password:\n\nNumber of key(s) added:        1\n\nNow try logging into the machine, with:   \"ssh '192.168.1.100'\"\nand check to make sure that only the key(s) you wanted were added.\n```\n\n다시 서버에 접속하여 ssh 설정을 바꾼다.\n\n```\n# /etc/ssh/sshd_config\nPasswordAuthentication no\nPermitRootLogin no\n```\n\n그 후 다시 `ssh` 서비스를 재시작한다.\n\n```\n$ sudo systemctl restart ssh\n```\n\n이후 ssh로 root로 로그인은 불가능하다.\n\n리눅스 계정이 있더라도 Proxmox VE 유저는 별도로 추가해야한다.\n`https://proxmox-ip:8006`으로 이동하여 proxmox 웹 환경에 접속하여\ndatacenter -> permissions -> user로 이동하여 유저를\n추가한다. `Realm`은 `Linux PAM`으로, 유저이름은 방금 추가한 리눅스 유저이름으로\n한다.\n\n![](/assets/proxmox-adduser.png)\n\n## 패키지 저장소 관리\n\n기업 지원 패키지는 유료이기 때문에 주석처리한다.\n\n```\nvi /etc/apt/sources.list.d/pve-enterprise.list\n```\n\n`/etc/apt/sources.list` 파일에 비 구독 저장소를 추가한다.\n\n```\ndeb http://download.proxmox.com/debian/pve bullseye pve-no-subscription\n```\n\n```\napt update\napt dist-upgrade\n```\n\n## 컨테이너 만들기\n\n다음의 명령어로 컨테이너 이미지 목록을 업데이트한다.\n\n```\n$ sudo pveam update\n$ sudo pveam available\n```\n\n## 유용한 명령어\n\n```\npct enter <vmid>\n```\n\n","code":"var Component=(()=>{var a=Object.create;var s=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var x=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),y=(r,e)=>{for(var d in e)s(r,d,{get:e[d],enumerable:!0})},i=(r,e,d,t)=>{if(e&&typeof e==\"object\"||typeof e==\"function\")for(let o of u(e))!g.call(r,o)&&o!==d&&s(r,o,{get:()=>e[o],enumerable:!(t=p(e,o))||t.enumerable});return r};var b=(r,e,d)=>(d=r!=null?a(m(r)):{},i(e||!r||!r.__esModule?s(d,\"default\",{value:r,enumerable:!0}):d,r)),w=r=>i(s({},\"__esModule\",{value:!0}),r);var h=x((j,c)=>{c.exports=_jsx_runtime});var _={};y(_,{default:()=>$,frontmatter:()=>f});var n=b(h()),f={title:\"Proxmox VE \\uAE30\\uCD08\\uC124\\uC815\",description:\"Proxmox VE \\uC124\\uCE58 \\uD6C4 \\uD574\\uC57C\\uD558\\uB294 \\uAE30\\uCD08 \\uC124\\uC815\",date:new Date(16790976e5),tags:null};function l(r){let e=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",pre:\"pre\",img:\"img\"},r.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{children:\"\\uC720\\uC800 \\uC124\\uC815\\uD558\\uAE30\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uD56D\\uC0C1 \\uC2DC\\uC2A4\\uD15C \\uAD6C\\uC131\\uD558\\uBA74 root \\uC678\\uC758 \\uC720\\uC800 \\uACC4\\uC815 \\uC0DD\\uC131\\uD558\\uACE0 SSH \\uC811\\uC18D \\uC81C\\uD55C\\uD558\\uC790.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uC11C\\uBC84\\uC5D0 \\uC811\\uC18D\\uD558\\uC5EC \",(0,n.jsx)(e.code,{children:\"adduser\"}),\"\\uB85C \\uC720\\uC800\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`$ adduser nyeong\n$ apt install sudo\n$ groupadd sudoers\n$ usermod -g suoders nyeong\n$ EDITOR=vi visudo\n$ su nyeong\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uB85C\\uCEEC\\uB85C \\uBE60\\uC838\\uB098\\uC640 SSH \\uACF5\\uAC1C\\uD0A4\\uB97C \\uC11C\\uBC84\\uB85C \\uBCF5\\uC0AC\\uD55C\\uB2E4.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`$ ssh-copy-id 192.168.1.100\n/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: \"/Users/nyeong/.ssh/id_ed25519.pub\"\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\nnyeong@192.168.1.100's password:\n\nNumber of key(s) added:        1\n\nNow try logging into the machine, with:   \"ssh '192.168.1.100'\"\nand check to make sure that only the key(s) you wanted were added.\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uB2E4\\uC2DC \\uC11C\\uBC84\\uC5D0 \\uC811\\uC18D\\uD558\\uC5EC ssh \\uC124\\uC815\\uC744 \\uBC14\\uAFBC\\uB2E4.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`# /etc/ssh/sshd_config\nPasswordAuthentication no\nPermitRootLogin no\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uADF8 \\uD6C4 \\uB2E4\\uC2DC \",(0,n.jsx)(e.code,{children:\"ssh\"}),\" \\uC11C\\uBE44\\uC2A4\\uB97C \\uC7AC\\uC2DC\\uC791\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`$ sudo systemctl restart ssh\n`})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uC774\\uD6C4 ssh\\uB85C root\\uB85C \\uB85C\\uADF8\\uC778\\uC740 \\uBD88\\uAC00\\uB2A5\\uD558\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.p,{children:[`\\uB9AC\\uB205\\uC2A4 \\uACC4\\uC815\\uC774 \\uC788\\uB354\\uB77C\\uB3C4 Proxmox VE \\uC720\\uC800\\uB294 \\uBCC4\\uB3C4\\uB85C \\uCD94\\uAC00\\uD574\\uC57C\\uD55C\\uB2E4.\n`,(0,n.jsx)(e.code,{children:\"https://proxmox-ip:8006\"}),`\\uC73C\\uB85C \\uC774\\uB3D9\\uD558\\uC5EC proxmox \\uC6F9 \\uD658\\uACBD\\uC5D0 \\uC811\\uC18D\\uD558\\uC5EC\ndatacenter -> permissions -> user\\uB85C \\uC774\\uB3D9\\uD558\\uC5EC \\uC720\\uC800\\uB97C\n\\uCD94\\uAC00\\uD55C\\uB2E4. `,(0,n.jsx)(e.code,{children:\"Realm\"}),\"\\uC740 \",(0,n.jsx)(e.code,{children:\"Linux PAM\"}),`\\uC73C\\uB85C, \\uC720\\uC800\\uC774\\uB984\\uC740 \\uBC29\\uAE08 \\uCD94\\uAC00\\uD55C \\uB9AC\\uB205\\uC2A4 \\uC720\\uC800\\uC774\\uB984\\uC73C\\uB85C\n\\uD55C\\uB2E4.`]}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.img,{src:\"/assets/proxmox-adduser.png\",alt:\"\"})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\uD328\\uD0A4\\uC9C0 \\uC800\\uC7A5\\uC18C \\uAD00\\uB9AC\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uAE30\\uC5C5 \\uC9C0\\uC6D0 \\uD328\\uD0A4\\uC9C0\\uB294 \\uC720\\uB8CC\\uC774\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC8FC\\uC11D\\uCC98\\uB9AC\\uD55C\\uB2E4.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`vi /etc/apt/sources.list.d/pve-enterprise.list\n`})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"/etc/apt/sources.list\"}),\" \\uD30C\\uC77C\\uC5D0 \\uBE44 \\uAD6C\\uB3C5 \\uC800\\uC7A5\\uC18C\\uB97C \\uCD94\\uAC00\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription\n`})}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`apt update\napt dist-upgrade\n`})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\uCEE8\\uD14C\\uC774\\uB108 \\uB9CC\\uB4E4\\uAE30\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uB2E4\\uC74C\\uC758 \\uBA85\\uB839\\uC5B4\\uB85C \\uCEE8\\uD14C\\uC774\\uB108 \\uC774\\uBBF8\\uC9C0 \\uBAA9\\uB85D\\uC744 \\uC5C5\\uB370\\uC774\\uD2B8\\uD55C\\uB2E4.\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`$ sudo pveam update\n$ sudo pveam available\n`})}),`\n`,(0,n.jsx)(e.h2,{children:\"\\uC720\\uC6A9\\uD55C \\uBA85\\uB839\\uC5B4\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{children:`pct enter <vmid>\n`})})]})}function v(r={}){let{wrapper:e}=r.components||{};return e?(0,n.jsx)(e,Object.assign({},r,{children:(0,n.jsx)(l,r)})):l(r)}var $=v;return w(_);})();\n;return Component;"},"_id":"proxmox-setup.md","_raw":{"sourceFilePath":"proxmox-setup.md","sourceFileName":"proxmox-setup.md","sourceFileDir":".","contentType":"markdown","flattenedPath":"proxmox-setup"},"type":"Note","slug":"proxmox-setup"}},"__N_SSG":true}