<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link data-next-font="" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/5e2f81e3348184c3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5e2f81e3348184c3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-4df221df76d0b5c0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9cdcdb934f7926cf.js" defer=""></script><script src="/_next/static/chunks/534-7c3f61d00df522a4.js" defer=""></script><script src="/_next/static/chunks/pages/n/%5B%5B...slug%5D%5D-f567fc50f29fb614.js" defer=""></script><script src="/_next/static/YrNYT-AGTprfVeMkSA0NP/_buildManifest.js" defer=""></script><script src="/_next/static/YrNYT-AGTprfVeMkSA0NP/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="font-serif antialiased container grid grid-cols-1 p-3"><nav class="mb-5"><a class="font-bold transition-colors text-gray-600 hover:text-gray-900 no-underline pr-2" href="/">하나씩</a><a class=" transition-colors text-gray-600 hover:text-gray-900 no-underline pr-2" href="/n">index</a></nav><main><article class="prose"><header><h1>OpenWrt</h1></header><h2 id="wireguard를-이용한-vpn-설정">Wireguard를 이용한 VPN 설정</h2>
<p>VPN은 공개 네트워크에서 비밀 네트워크로 접속할 때 유용한 보안 기술이다. 이를 이용하면 외부에서도 홈 네트워크에 안전하고 편리하게 접속할 수 있다.</p>
<p>다양한 프로토콜이 있는데, 최근 리눅스 커널(5.6)에 포함된 wireguard가 편리하다.</p>
<p>OpenWRT를 VPN 서버로 이용할 수 있다.</p>
<p><a href="https://openwrt.org/docs/guide-user/services/vpn/wireguard/basics" rel="nofollow">WireGuard basics</a></p>
<h3 id="설치">설치</h3>
<p>wireguard 프로토콜 자체는 커널에 포함되었으나, 관리도구는 별도로 설치해야한다. LuCI에서 편히 쓰고자 설치하는 거라서 없어도 무방하긴 하다. SSH로 접속하여 다음을 진행한다:</p>
<pre><code class="code-highlight"><span class="code-line">opkg update
</span><span class="code-line">opkg install luci-proto-wireguard luci-app-wireguard
</span><span class="code-line">/etc/init.d/network restart
</span></code></pre>
<p>혹은 LuCI → System → Software에 접속하여 두 패키지를 찾아 설치한다. 그 후 LuCI → System → Startup → Initscripts → network에서 restart를 누른다.</p>
<h3 id="키쌍-생성하기">키쌍 생성하기</h3>
<p>wireguard는 공개키 암호화 방식을 이용한다. 다음 명령어로 공개키 쌍을 생성하자:</p>
<pre><code class="code-highlight"><span class="code-line">mkdir /etc/wireguard
</span><span class="code-line">cd /etc/wireguard
</span><span class="code-line">wg genkey | tee uibook | wg pubkey &gt; uibook.pub
</span><span class="code-line">chmod 600 uibook
</span></code></pre>
<p><code>/etc/wireguard</code>는 키 저장을 위하여 임의로 만든 공간이다. <code>wg genkey</code> 명령어로 비밀키를, <code>wg pubkey</code> 명령어로 공개키를 만든다. 그중 비밀키는 반드시 권한을 <code>600</code>으로 수정하자.</p>
<h3 id="인터페이스-생성하기">인터페이스 생성하기</h3>
<p>새로운 프로토콜(wireguard)를 사용하기 때문에, 통신을 위해서 새로운 인터페이스를 정의해야한다. LuCI → Network → Interfaces에서 할 수 있다.</p>
<ul>
<li>이름: wg0. 그냥 이걸 제일 많이 쓰더라.</li>
<li>protocol: WireGuard VPN</li>
<li>private key: 아까 생성한 비밀키</li>
<li>public key: 아까 생성한 공개키</li>
<li>listen port: 49152 ~ 65535에서 고르면 된다는데 그냥 두면 랜덤 되는 듯</li>
<li>ip addresses: 해당 인터페이스에 할당할 IP이다. 10.9.0.1/24로 했다. 이 IP가 게이트웨이 역할을 한다.</li>
</ul>
<p><code>/etc/config/network</code> 파일을 편집하여서 할 수도 있다. 아래처럼 추가하면 된다.</p>
<pre><code class="code-highlight"><span class="code-line">config interface &#x27;wg0&#x27;
</span><span class="code-line">        option proto &#x27;wireguard&#x27;
</span><span class="code-line">        option private_key &#x27;[비밀키 내용 입력]&#x27;
</span><span class="code-line">        list addresses &#x27;10.9.0.1/24&#x27;
</span></code></pre>
<h3 id="피어-설정하기">피어 설정하기</h3>
<p>같은 곳에서 피어 설정도 같이 진행해야 한다. 피어란 접속하고자 하는 기기이다. 아래의 앱을 이용하면 편리하게 접속할 수 있다.</p>
<p><a href="https://www.wireguard.com/install/" rel="nofollow">Installation - WireGuard</a></p>
<p>접속자도 공개키/비밀키 쌍을 만들고 공개키를 wireguard 서버에 등록해야한다. 그러나 서버에서 공개키/비밀키를 생성하고 이 자체를 공유해버릴 수도 있다.</p>
<p>따라서 LuCI에서 <code>Generate new key pair</code>로 키쌍을 만들어버리고, 설정을 완료한 후 해당 설정을 QR 코드나 conf 파일 형태로 접속을 원하는 피어에 공유하여 등록하면 편하게 피어를 설정할 수 있다. QR코드로 보기 위해서는 qrencode 패키지를 설치해야한다.</p>
<ul>
<li>Public Key: 접속하고자 하는 장치의 공개키</li>
<li>Private Key: 접속하고자 하는 장치의 비밀키. 접속에는 필요 없지만 이를 넣으면 설정파일 공유할 때 편해진다.</li>
<li>Preshared Key: 사실 뭔지 모르겠다.</li>
<li>Allowed IPs: 피어가 터널 안에서 쓰도록 허용한 IP 대역.</li>
<li>Persistent Keep Alive: 25가 권장값인듯</li>
</ul>
<pre><code class="code-highlight"><span class="code-line">config wireguard_wg0
</span><span class="code-line">        option public_key &#x27;cIDLafiUna6OyxWd4aCtmTpGt1XIaCGVzmfEuEC4nmQ=&#x27;
</span><span class="code-line">        option private_key &#x27;[검열 삭제]&#x27;
</span><span class="code-line">        option preshared_key &#x27;[검열 삭제]&#x27;
</span><span class="code-line">        list allowed_ips &#x27;10.9.0.0/24&#x27;
</span><span class="code-line">        option persistent_keepalive &#x27;25&#x27;
</span></code></pre>
<p>설정 후 가장 밑의 <code>Generate configuration...</code>을 누르면 설정을 피어에게 내보낼 수 있다. 이를 복사하거나 QR코드로 촬영하여 등록한다.</p>
<pre><code class="code-highlight"><span class="code-line">[Interface]
</span><span class="code-line">PrivateKey = 이 클라이언트의 개인키
</span><span class="code-line">Address = 할당 받을 IP (예: 10.9.0.3/24)
</span><span class="code-line">DNS = 라우터 DNS (192.168.1.1)
</span><span class="code-line">
</span><span class="code-line">[Peer]
</span><span class="code-line">PublicKey = 서버의 공개키
</span><span class="code-line">AllowedIPs = 0.0.0.0/0
</span><span class="code-line">Endpoint = 서버주소:포트
</span></code></pre>
<p>여기서 <code>AllowedIPs</code>는 VPN을 거칠 IP를 의미한다. <code>0.0.0.0/0</code>으로 되어있다면
모든 접속을 VPN을 거쳐서 하게 된다.</p>
<h3 id="방화벽-설정">방화벽 설정</h3>
<p>이제 방화벽을 개방해주어야한다. LuCI → Network → Firewall에서 설정 할 수 있다. 이 작업은 <code>/etc/config/firewall</code>을 수정하여서 할 수도 있다.</p>
<p>General Settings 하단의 Zones에서 Add를 눌러 존을 만든다.</p>
<ul>
<li>Name: 원하는 이름으로 한다. 여기서는 <code>wireguard</code>로 하였다.</li>
<li>Input/Output: Accept</li>
<li>Forward: Reject</li>
<li>Masquerading: 체크하라는데 뭔지는 모르겠다.</li>
<li>MSS clamping: 체크하라는데 뭔지는 모르겠다.</li>
<li>Covered Networks: 아까 만든 <code>wg0</code></li>
<li>Allow forward to destination zones: 이 존에서 어떤 존으로 갈 수 있는 지를 묻는 것이다. VPN으로 접속시 내부 네트워크와 외부망을 모두 쓰고 싶으므로 <code>lan</code>, <code>wan</code>을 고른다</li>
<li>Allow forward to source zones: 외부망에서는 접근을 원치 않으므로 <code>lan</code>만 고른다.</li>
</ul>
<pre><code class="code-highlight"><span class="code-line">config zone
</span><span class="code-line">        option name &#x27;wireguard&#x27;
</span><span class="code-line">        option input &#x27;ACCEPT&#x27;
</span><span class="code-line">        option output &#x27;ACCEPT&#x27;
</span><span class="code-line">        option forward &#x27;REJECT&#x27;
</span><span class="code-line">        option masq &#x27;1&#x27;
</span><span class="code-line">        option mtu_fix &#x27;1&#x27;
</span><span class="code-line">        list network &#x27;wg0&#x27;
</span><span class="code-line">
</span><span class="code-line">config forwarding
</span><span class="code-line">        option src &#x27;wireguard&#x27;
</span><span class="code-line">        option dest &#x27;lan&#x27;
</span><span class="code-line">
</span><span class="code-line">config forwarding
</span><span class="code-line">        option src &#x27;wireguard&#x27;
</span><span class="code-line">        option dest &#x27;wan&#x27;
</span><span class="code-line">
</span><span class="code-line">config forwarding
</span><span class="code-line">        option src &#x27;lan&#x27;
</span><span class="code-line">        option dest &#x27;wireguard&#x27;
</span></code></pre>
<p>이제 포트를 개방해줄 차례이다.</p>
<p>Traffic Rules 탭에 들어가 Add를 누른다.</p>
<ul>
<li>Name: 작명 규칙에 맞게 <code>Allow-Wireguard</code>로 하자.</li>
<li>Protocol: wireguard는 UDP를 사용하므로 UDP만 체크한다</li>
<li>Source zone: 외부에서의 접속이므로 <code>wan</code>에 체크한다.</li>
<li>Destination port: 기본 wireguard 포트인 51820을 쓴다.</li>
<li>Action: 당연히 accept</li>
</ul></article><footer></footer></main><footer><p>© <!-- -->2023<!-- --> An Nyeong. <a target="_blank" href="https://github.com/nyeong/hanassig/blob/main/LICENSE">CC BY-SA</a></p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":"var Component=(()=\u003e{var t=Object.create;var r=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty;var w=(i,e)=\u003e()=\u003e(e||i((e={exports:{}}).exports,e),e.exports),N=(i,e)=\u003e{for(var c in e)r(i,c,{get:e[c],enumerable:!0})},a=(i,e,c,d)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let l of u(e))!g.call(i,l)\u0026\u0026l!==c\u0026\u0026r(i,l,{get:()=\u003ee[l],enumerable:!(d=p(e,l))||d.enumerable});return i};var f=(i,e,c)=\u003e(c=i!=null?t(m(i)):{},a(e||!i||!i.__esModule?r(c,\"default\",{value:i,enumerable:!0}):c,i)),P=i=\u003ea(r({},\"__esModule\",{value:!0}),i);var o=w((b,s)=\u003e{s.exports=_jsx_runtime});var C={};N(C,{default:()=\u003ey,frontmatter:()=\u003ek});var n=f(o()),k={title:\"OpenWrt\",description:\"OpenWrt\\uB85C \\uB77C\\uC6B0\\uD130 \\uC368\\uBA39\\uAE30\",date:new Date(16777152e5),tags:null};function h(i){let e=Object.assign({h2:\"h2\",p:\"p\",a:\"a\",h3:\"h3\",pre:\"pre\",code:\"code\",span:\"span\",ul:\"ul\",li:\"li\"},i.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h2,{id:\"wireguard\\uB97C-\\uC774\\uC6A9\\uD55C-vpn-\\uC124\\uC815\",children:\"Wireguard\\uB97C \\uC774\\uC6A9\\uD55C VPN \\uC124\\uC815\"}),`\n`,(0,n.jsx)(e.p,{children:\"VPN\\uC740 \\uACF5\\uAC1C \\uB124\\uD2B8\\uC6CC\\uD06C\\uC5D0\\uC11C \\uBE44\\uBC00 \\uB124\\uD2B8\\uC6CC\\uD06C\\uB85C \\uC811\\uC18D\\uD560 \\uB54C \\uC720\\uC6A9\\uD55C \\uBCF4\\uC548 \\uAE30\\uC220\\uC774\\uB2E4. \\uC774\\uB97C \\uC774\\uC6A9\\uD558\\uBA74 \\uC678\\uBD80\\uC5D0\\uC11C\\uB3C4 \\uD648 \\uB124\\uD2B8\\uC6CC\\uD06C\\uC5D0 \\uC548\\uC804\\uD558\\uACE0 \\uD3B8\\uB9AC\\uD558\\uAC8C \\uC811\\uC18D\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uB2E4\\uC591\\uD55C \\uD504\\uB85C\\uD1A0\\uCF5C\\uC774 \\uC788\\uB294\\uB370, \\uCD5C\\uADFC \\uB9AC\\uB205\\uC2A4 \\uCEE4\\uB110(5.6)\\uC5D0 \\uD3EC\\uD568\\uB41C wireguard\\uAC00 \\uD3B8\\uB9AC\\uD558\\uB2E4.\"}),`\n`,(0,n.jsx)(e.p,{children:\"OpenWRT\\uB97C VPN \\uC11C\\uBC84\\uB85C \\uC774\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://openwrt.org/docs/guide-user/services/vpn/wireguard/basics\",rel:\"nofollow\",children:\"WireGuard basics\"})}),`\n`,(0,n.jsx)(e.h3,{id:\"\\uC124\\uCE58\",children:\"\\uC124\\uCE58\"}),`\n`,(0,n.jsx)(e.p,{children:\"wireguard \\uD504\\uB85C\\uD1A0\\uCF5C \\uC790\\uCCB4\\uB294 \\uCEE4\\uB110\\uC5D0 \\uD3EC\\uD568\\uB418\\uC5C8\\uC73C\\uB098, \\uAD00\\uB9AC\\uB3C4\\uAD6C\\uB294 \\uBCC4\\uB3C4\\uB85C \\uC124\\uCE58\\uD574\\uC57C\\uD55C\\uB2E4. LuCI\\uC5D0\\uC11C \\uD3B8\\uD788 \\uC4F0\\uACE0\\uC790 \\uC124\\uCE58\\uD558\\uB294 \\uAC70\\uB77C\\uC11C \\uC5C6\\uC5B4\\uB3C4 \\uBB34\\uBC29\\uD558\\uAE34 \\uD558\\uB2E4. SSH\\uB85C \\uC811\\uC18D\\uD558\\uC5EC \\uB2E4\\uC74C\\uC744 \\uC9C4\\uD589\\uD55C\\uB2E4:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`opkg update\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`opkg install luci-proto-wireguard luci-app-wireguard\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`/etc/init.d/network restart\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uD639\\uC740 LuCI \\u2192 System \\u2192 Software\\uC5D0 \\uC811\\uC18D\\uD558\\uC5EC \\uB450 \\uD328\\uD0A4\\uC9C0\\uB97C \\uCC3E\\uC544 \\uC124\\uCE58\\uD55C\\uB2E4. \\uADF8 \\uD6C4 LuCI \\u2192 System \\u2192 Startup \\u2192 Initscripts \\u2192 network\\uC5D0\\uC11C restart\\uB97C \\uB204\\uB978\\uB2E4.\"}),`\n`,(0,n.jsx)(e.h3,{id:\"\\uD0A4\\uC30D-\\uC0DD\\uC131\\uD558\\uAE30\",children:\"\\uD0A4\\uC30D \\uC0DD\\uC131\\uD558\\uAE30\"}),`\n`,(0,n.jsx)(e.p,{children:\"wireguard\\uB294 \\uACF5\\uAC1C\\uD0A4 \\uC554\\uD638\\uD654 \\uBC29\\uC2DD\\uC744 \\uC774\\uC6A9\\uD55C\\uB2E4. \\uB2E4\\uC74C \\uBA85\\uB839\\uC5B4\\uB85C \\uACF5\\uAC1C\\uD0A4 \\uC30D\\uC744 \\uC0DD\\uC131\\uD558\\uC790:\"}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`mkdir /etc/wireguard\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`cd /etc/wireguard\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`wg genkey | tee uibook | wg pubkey \u003e uibook.pub\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`chmod 600 uibook\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"/etc/wireguard\"}),\"\\uB294 \\uD0A4 \\uC800\\uC7A5\\uC744 \\uC704\\uD558\\uC5EC \\uC784\\uC758\\uB85C \\uB9CC\\uB4E0 \\uACF5\\uAC04\\uC774\\uB2E4. \",(0,n.jsx)(e.code,{children:\"wg genkey\"}),\" \\uBA85\\uB839\\uC5B4\\uB85C \\uBE44\\uBC00\\uD0A4\\uB97C, \",(0,n.jsx)(e.code,{children:\"wg pubkey\"}),\" \\uBA85\\uB839\\uC5B4\\uB85C \\uACF5\\uAC1C\\uD0A4\\uB97C \\uB9CC\\uB4E0\\uB2E4. \\uADF8\\uC911 \\uBE44\\uBC00\\uD0A4\\uB294 \\uBC18\\uB4DC\\uC2DC \\uAD8C\\uD55C\\uC744 \",(0,n.jsx)(e.code,{children:\"600\"}),\"\\uC73C\\uB85C \\uC218\\uC815\\uD558\\uC790.\"]}),`\n`,(0,n.jsx)(e.h3,{id:\"\\uC778\\uD130\\uD398\\uC774\\uC2A4-\\uC0DD\\uC131\\uD558\\uAE30\",children:\"\\uC778\\uD130\\uD398\\uC774\\uC2A4 \\uC0DD\\uC131\\uD558\\uAE30\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uC0C8\\uB85C\\uC6B4 \\uD504\\uB85C\\uD1A0\\uCF5C(wireguard)\\uB97C \\uC0AC\\uC6A9\\uD558\\uAE30 \\uB54C\\uBB38\\uC5D0, \\uD1B5\\uC2E0\\uC744 \\uC704\\uD574\\uC11C \\uC0C8\\uB85C\\uC6B4 \\uC778\\uD130\\uD398\\uC774\\uC2A4\\uB97C \\uC815\\uC758\\uD574\\uC57C\\uD55C\\uB2E4. LuCI \\u2192 Network \\u2192 Interfaces\\uC5D0\\uC11C \\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"\\uC774\\uB984: wg0. \\uADF8\\uB0E5 \\uC774\\uAC78 \\uC81C\\uC77C \\uB9CE\\uC774 \\uC4F0\\uB354\\uB77C.\"}),`\n`,(0,n.jsx)(e.li,{children:\"protocol: WireGuard VPN\"}),`\n`,(0,n.jsx)(e.li,{children:\"private key: \\uC544\\uAE4C \\uC0DD\\uC131\\uD55C \\uBE44\\uBC00\\uD0A4\"}),`\n`,(0,n.jsx)(e.li,{children:\"public key: \\uC544\\uAE4C \\uC0DD\\uC131\\uD55C \\uACF5\\uAC1C\\uD0A4\"}),`\n`,(0,n.jsx)(e.li,{children:\"listen port: 49152 ~ 65535\\uC5D0\\uC11C \\uACE0\\uB974\\uBA74 \\uB41C\\uB2E4\\uB294\\uB370 \\uADF8\\uB0E5 \\uB450\\uBA74 \\uB79C\\uB364 \\uB418\\uB294 \\uB4EF\"}),`\n`,(0,n.jsx)(e.li,{children:\"ip addresses: \\uD574\\uB2F9 \\uC778\\uD130\\uD398\\uC774\\uC2A4\\uC5D0 \\uD560\\uB2F9\\uD560 IP\\uC774\\uB2E4. 10.9.0.1/24\\uB85C \\uD588\\uB2E4. \\uC774 IP\\uAC00 \\uAC8C\\uC774\\uD2B8\\uC6E8\\uC774 \\uC5ED\\uD560\\uC744 \\uD55C\\uB2E4.\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.code,{children:\"/etc/config/network\"}),\" \\uD30C\\uC77C\\uC744 \\uD3B8\\uC9D1\\uD558\\uC5EC\\uC11C \\uD560 \\uC218\\uB3C4 \\uC788\\uB2E4. \\uC544\\uB798\\uCC98\\uB7FC \\uCD94\\uAC00\\uD558\\uBA74 \\uB41C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`config interface 'wg0'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option proto 'wireguard'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option private_key '[\\uBE44\\uBC00\\uD0A4 \\uB0B4\\uC6A9 \\uC785\\uB825]'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        list addresses '10.9.0.1/24'\n`})]})}),`\n`,(0,n.jsx)(e.h3,{id:\"\\uD53C\\uC5B4-\\uC124\\uC815\\uD558\\uAE30\",children:\"\\uD53C\\uC5B4 \\uC124\\uC815\\uD558\\uAE30\"}),`\n`,(0,n.jsx)(e.p,{children:\"\\uAC19\\uC740 \\uACF3\\uC5D0\\uC11C \\uD53C\\uC5B4 \\uC124\\uC815\\uB3C4 \\uAC19\\uC774 \\uC9C4\\uD589\\uD574\\uC57C \\uD55C\\uB2E4. \\uD53C\\uC5B4\\uB780 \\uC811\\uC18D\\uD558\\uACE0\\uC790 \\uD558\\uB294 \\uAE30\\uAE30\\uC774\\uB2E4. \\uC544\\uB798\\uC758 \\uC571\\uC744 \\uC774\\uC6A9\\uD558\\uBA74 \\uD3B8\\uB9AC\\uD558\\uAC8C \\uC811\\uC18D\\uD560 \\uC218 \\uC788\\uB2E4.\"}),`\n`,(0,n.jsx)(e.p,{children:(0,n.jsx)(e.a,{href:\"https://www.wireguard.com/install/\",rel:\"nofollow\",children:\"Installation - WireGuard\"})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uC811\\uC18D\\uC790\\uB3C4 \\uACF5\\uAC1C\\uD0A4/\\uBE44\\uBC00\\uD0A4 \\uC30D\\uC744 \\uB9CC\\uB4E4\\uACE0 \\uACF5\\uAC1C\\uD0A4\\uB97C wireguard \\uC11C\\uBC84\\uC5D0 \\uB4F1\\uB85D\\uD574\\uC57C\\uD55C\\uB2E4. \\uADF8\\uB7EC\\uB098 \\uC11C\\uBC84\\uC5D0\\uC11C \\uACF5\\uAC1C\\uD0A4/\\uBE44\\uBC00\\uD0A4\\uB97C \\uC0DD\\uC131\\uD558\\uACE0 \\uC774 \\uC790\\uCCB4\\uB97C \\uACF5\\uC720\\uD574\\uBC84\\uB9B4 \\uC218\\uB3C4 \\uC788\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uB530\\uB77C\\uC11C LuCI\\uC5D0\\uC11C \",(0,n.jsx)(e.code,{children:\"Generate new key pair\"}),\"\\uB85C \\uD0A4\\uC30D\\uC744 \\uB9CC\\uB4E4\\uC5B4\\uBC84\\uB9AC\\uACE0, \\uC124\\uC815\\uC744 \\uC644\\uB8CC\\uD55C \\uD6C4 \\uD574\\uB2F9 \\uC124\\uC815\\uC744 QR \\uCF54\\uB4DC\\uB098 conf \\uD30C\\uC77C \\uD615\\uD0DC\\uB85C \\uC811\\uC18D\\uC744 \\uC6D0\\uD558\\uB294 \\uD53C\\uC5B4\\uC5D0 \\uACF5\\uC720\\uD558\\uC5EC \\uB4F1\\uB85D\\uD558\\uBA74 \\uD3B8\\uD558\\uAC8C \\uD53C\\uC5B4\\uB97C \\uC124\\uC815\\uD560 \\uC218 \\uC788\\uB2E4. QR\\uCF54\\uB4DC\\uB85C \\uBCF4\\uAE30 \\uC704\\uD574\\uC11C\\uB294 qrencode \\uD328\\uD0A4\\uC9C0\\uB97C \\uC124\\uCE58\\uD574\\uC57C\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Public Key: \\uC811\\uC18D\\uD558\\uACE0\\uC790 \\uD558\\uB294 \\uC7A5\\uCE58\\uC758 \\uACF5\\uAC1C\\uD0A4\"}),`\n`,(0,n.jsx)(e.li,{children:\"Private Key: \\uC811\\uC18D\\uD558\\uACE0\\uC790 \\uD558\\uB294 \\uC7A5\\uCE58\\uC758 \\uBE44\\uBC00\\uD0A4. \\uC811\\uC18D\\uC5D0\\uB294 \\uD544\\uC694 \\uC5C6\\uC9C0\\uB9CC \\uC774\\uB97C \\uB123\\uC73C\\uBA74 \\uC124\\uC815\\uD30C\\uC77C \\uACF5\\uC720\\uD560 \\uB54C \\uD3B8\\uD574\\uC9C4\\uB2E4.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Preshared Key: \\uC0AC\\uC2E4 \\uBB54\\uC9C0 \\uBAA8\\uB974\\uACA0\\uB2E4.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Allowed IPs: \\uD53C\\uC5B4\\uAC00 \\uD130\\uB110 \\uC548\\uC5D0\\uC11C \\uC4F0\\uB3C4\\uB85D \\uD5C8\\uC6A9\\uD55C IP \\uB300\\uC5ED.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Persistent Keep Alive: 25\\uAC00 \\uAD8C\\uC7A5\\uAC12\\uC778\\uB4EF\"}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`config wireguard_wg0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option public_key 'cIDLafiUna6OyxWd4aCtmTpGt1XIaCGVzmfEuEC4nmQ='\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option private_key '[\\uAC80\\uC5F4 \\uC0AD\\uC81C]'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option preshared_key '[\\uAC80\\uC5F4 \\uC0AD\\uC81C]'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        list allowed_ips '10.9.0.0/24'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option persistent_keepalive '25'\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uC124\\uC815 \\uD6C4 \\uAC00\\uC7A5 \\uBC11\\uC758 \",(0,n.jsx)(e.code,{children:\"Generate configuration...\"}),\"\\uC744 \\uB204\\uB974\\uBA74 \\uC124\\uC815\\uC744 \\uD53C\\uC5B4\\uC5D0\\uAC8C \\uB0B4\\uBCF4\\uB0BC \\uC218 \\uC788\\uB2E4. \\uC774\\uB97C \\uBCF5\\uC0AC\\uD558\\uAC70\\uB098 QR\\uCF54\\uB4DC\\uB85C \\uCD2C\\uC601\\uD558\\uC5EC \\uB4F1\\uB85D\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`[Interface]\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`PrivateKey = \\uC774 \\uD074\\uB77C\\uC774\\uC5B8\\uD2B8\\uC758 \\uAC1C\\uC778\\uD0A4\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Address = \\uD560\\uB2F9 \\uBC1B\\uC744 IP (\\uC608: 10.9.0.3/24)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`DNS = \\uB77C\\uC6B0\\uD130 DNS (192.168.1.1)\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`[Peer]\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`PublicKey = \\uC11C\\uBC84\\uC758 \\uACF5\\uAC1C\\uD0A4\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`AllowedIPs = 0.0.0.0/0\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`Endpoint = \\uC11C\\uBC84\\uC8FC\\uC18C:\\uD3EC\\uD2B8\n`})]})}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uC5EC\\uAE30\\uC11C \",(0,n.jsx)(e.code,{children:\"AllowedIPs\"}),\"\\uB294 VPN\\uC744 \\uAC70\\uCE60 IP\\uB97C \\uC758\\uBBF8\\uD55C\\uB2E4. \",(0,n.jsx)(e.code,{children:\"0.0.0.0/0\"}),`\\uC73C\\uB85C \\uB418\\uC5B4\\uC788\\uB2E4\\uBA74\n\\uBAA8\\uB4E0 \\uC811\\uC18D\\uC744 VPN\\uC744 \\uAC70\\uCCD0\\uC11C \\uD558\\uAC8C \\uB41C\\uB2E4.`]}),`\n`,(0,n.jsx)(e.h3,{id:\"\\uBC29\\uD654\\uBCBD-\\uC124\\uC815\",children:\"\\uBC29\\uD654\\uBCBD \\uC124\\uC815\"}),`\n`,(0,n.jsxs)(e.p,{children:[\"\\uC774\\uC81C \\uBC29\\uD654\\uBCBD\\uC744 \\uAC1C\\uBC29\\uD574\\uC8FC\\uC5B4\\uC57C\\uD55C\\uB2E4. LuCI \\u2192 Network \\u2192 Firewall\\uC5D0\\uC11C \\uC124\\uC815 \\uD560 \\uC218 \\uC788\\uB2E4. \\uC774 \\uC791\\uC5C5\\uC740 \",(0,n.jsx)(e.code,{children:\"/etc/config/firewall\"}),\"\\uC744 \\uC218\\uC815\\uD558\\uC5EC\\uC11C \\uD560 \\uC218\\uB3C4 \\uC788\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.p,{children:\"General Settings \\uD558\\uB2E8\\uC758 Zones\\uC5D0\\uC11C Add\\uB97C \\uB20C\\uB7EC \\uC874\\uC744 \\uB9CC\\uB4E0\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Name: \\uC6D0\\uD558\\uB294 \\uC774\\uB984\\uC73C\\uB85C \\uD55C\\uB2E4. \\uC5EC\\uAE30\\uC11C\\uB294 \",(0,n.jsx)(e.code,{children:\"wireguard\"}),\"\\uB85C \\uD558\\uC600\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Input/Output: Accept\"}),`\n`,(0,n.jsx)(e.li,{children:\"Forward: Reject\"}),`\n`,(0,n.jsx)(e.li,{children:\"Masquerading: \\uCCB4\\uD06C\\uD558\\uB77C\\uB294\\uB370 \\uBB54\\uC9C0\\uB294 \\uBAA8\\uB974\\uACA0\\uB2E4.\"}),`\n`,(0,n.jsx)(e.li,{children:\"MSS clamping: \\uCCB4\\uD06C\\uD558\\uB77C\\uB294\\uB370 \\uBB54\\uC9C0\\uB294 \\uBAA8\\uB974\\uACA0\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Covered Networks: \\uC544\\uAE4C \\uB9CC\\uB4E0 \",(0,n.jsx)(e.code,{children:\"wg0\"})]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Allow forward to destination zones: \\uC774 \\uC874\\uC5D0\\uC11C \\uC5B4\\uB5A4 \\uC874\\uC73C\\uB85C \\uAC08 \\uC218 \\uC788\\uB294 \\uC9C0\\uB97C \\uBB3B\\uB294 \\uAC83\\uC774\\uB2E4. VPN\\uC73C\\uB85C \\uC811\\uC18D\\uC2DC \\uB0B4\\uBD80 \\uB124\\uD2B8\\uC6CC\\uD06C\\uC640 \\uC678\\uBD80\\uB9DD\\uC744 \\uBAA8\\uB450 \\uC4F0\\uACE0 \\uC2F6\\uC73C\\uBBC0\\uB85C \",(0,n.jsx)(e.code,{children:\"lan\"}),\", \",(0,n.jsx)(e.code,{children:\"wan\"}),\"\\uC744 \\uACE0\\uB978\\uB2E4\"]}),`\n`,(0,n.jsxs)(e.li,{children:[\"Allow forward to source zones: \\uC678\\uBD80\\uB9DD\\uC5D0\\uC11C\\uB294 \\uC811\\uADFC\\uC744 \\uC6D0\\uCE58 \\uC54A\\uC73C\\uBBC0\\uB85C \",(0,n.jsx)(e.code,{children:\"lan\"}),\"\\uB9CC \\uACE0\\uB978\\uB2E4.\"]}),`\n`]}),`\n`,(0,n.jsx)(e.pre,{children:(0,n.jsxs)(e.code,{className:\"code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`config zone\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option name 'wireguard'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option input 'ACCEPT'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option output 'ACCEPT'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option forward 'REJECT'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option masq '1'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option mtu_fix '1'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        list network 'wg0'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`config forwarding\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option src 'wireguard'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option dest 'lan'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`config forwarding\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option src 'wireguard'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option dest 'wan'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`config forwarding\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option src 'lan'\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`        option dest 'wireguard'\n`})]})}),`\n`,(0,n.jsx)(e.p,{children:\"\\uC774\\uC81C \\uD3EC\\uD2B8\\uB97C \\uAC1C\\uBC29\\uD574\\uC904 \\uCC28\\uB840\\uC774\\uB2E4.\"}),`\n`,(0,n.jsx)(e.p,{children:\"Traffic Rules \\uD0ED\\uC5D0 \\uB4E4\\uC5B4\\uAC00 Add\\uB97C \\uB204\\uB978\\uB2E4.\"}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Name: \\uC791\\uBA85 \\uADDC\\uCE59\\uC5D0 \\uB9DE\\uAC8C \",(0,n.jsx)(e.code,{children:\"Allow-Wireguard\"}),\"\\uB85C \\uD558\\uC790.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Protocol: wireguard\\uB294 UDP\\uB97C \\uC0AC\\uC6A9\\uD558\\uBBC0\\uB85C UDP\\uB9CC \\uCCB4\\uD06C\\uD55C\\uB2E4\"}),`\n`,(0,n.jsxs)(e.li,{children:[\"Source zone: \\uC678\\uBD80\\uC5D0\\uC11C\\uC758 \\uC811\\uC18D\\uC774\\uBBC0\\uB85C \",(0,n.jsx)(e.code,{children:\"wan\"}),\"\\uC5D0 \\uCCB4\\uD06C\\uD55C\\uB2E4.\"]}),`\n`,(0,n.jsx)(e.li,{children:\"Destination port: \\uAE30\\uBCF8 wireguard \\uD3EC\\uD2B8\\uC778 51820\\uC744 \\uC4F4\\uB2E4.\"}),`\n`,(0,n.jsx)(e.li,{children:\"Action: \\uB2F9\\uC5F0\\uD788 accept\"}),`\n`]})]})}function I(i={}){let{wrapper:e}=i.components||{};return e?(0,n.jsx)(e,Object.assign({},i,{children:(0,n.jsx)(h,i)})):h(i)}var y=I;return P(C);})();\n;return Component;","title":"OpenWrt"},"__N_SSG":true},"page":"/n/[[...slug]]","query":{"slug":["openwrt"]},"buildId":"YrNYT-AGTprfVeMkSA0NP","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>